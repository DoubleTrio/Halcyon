require 'origin.common'
require 'halcyon.PartnerEssentials'
require 'halcyon.GeneralFunctions'
require 'halcyon.CharacterEssentials'
require 'halcyon.ground.guild_third_floor_lobby.guild_third_floor_lobby_helper'


guild_third_floor_lobby_ch_5 = {}

function guild_third_floor_lobby_ch_5.SetupGround()
	
	if SV.Chapter5.FinishedExpeditionAddress then
		local noctowl = CharacterEssentials.MakeCharactersFromList({
			{'Noctowl', 'Noctowl'}
		})
		
		GAME:FadeIn(20)
	else
		
	end	
end



----------------
--NPC Scripts
----------------
function guild_third_floor_lobby_ch_5.Noctowl_Action(chara, activator)

end
	

------------------------
--Cutscene Scripts
------------------------
function guild_third_floor_lobby_ch_5.ExpeditionAddress()
	local hero = CH('PLAYER')
	local partner = CH('Teammate1')

	local tropius, noctowl, audino, snubbull, growlithe, zigzagoon, girafarig, 
		  breloom, mareep, cranidos = guild_third_floor_lobby_helper.SetupMorningAddress()

	local tail = CharacterEssentials.MakeCharactersFromList({{'Tail'}})
	
	GROUND:TeleportTo(breloom, 632, 280, Direction.Left)
	GROUND:TeleportTo(girafarig, 632, 312, Direction.Left)

	UI:SetSpeaker(tropius)
	UI:SetSpeakerEmotion("Normal")
	GROUND:CharSetEmote(tropius, "happy", 0)
	UI:WaitShowDialogue("One for all...")
	GAME:WaitFrames(20)
	

	UI:SetSpeaker('[color=#00FFFF]Everyone[color]', true, "", -1, "", RogueEssence.Data.Gender.Unknown)
	GROUND:CharSetEmote(tropius, "", 0)
	GROUND:CharSetEmote(growlithe, "happy", 0)
	GROUND:CharSetEmote(zigzagoon, "happy", 0)
	GROUND:CharSetEmote(mareep, "happy", 0)
	GROUND:CharSetEmote(audino, "happy", 0)
	GROUND:CharSetEmote(partner, "happy", 0)
	UI:WaitShowDialogue("AND ALL FOR ONE!")
	
	GAME:WaitFrames(20)
	GROUND:CharSetEmote(growlithe, "", 0)
	GROUND:CharSetEmote(zigzagoon, "", 0)
	GROUND:CharSetEmote(mareep, "", 0)
	GROUND:CharSetEmote(audino, "", 0)
	GROUND:CharSetEmote(partner, "", 0)
	
	--kino interrupts
	UI:SetSpeaker(STRINGS:Format("\\uE040"), true, "", -1, "", RogueEssence.Data.Gender.Unknown)
	SOUND:FadeOutBGM(60)	
	local coro1 = TASK:BranchCoroutine(function() GAME:WaitFrames(22)
												  GeneralFunctions.EmoteAndPause(growlithe, "Exclaim", true) end)
	local coro2 = TASK:BranchCoroutine(function() GAME:WaitFrames(28)
												  GROUND:CharSetEmote(zigzagoon, "exclaim", 1) end)
	local coro3 = TASK:BranchCoroutine(function() GAME:WaitFrames(32)
												  GROUND:CharSetEmote(cranidos, "notice", 1) end)
	local coro4 = TASK:BranchCoroutine(function() GAME:WaitFrames(20)
												  GROUND:CharSetEmote(mareep, "exclaim", 1) end)
	local coro5 = TASK:BranchCoroutine(function() GAME:WaitFrames(26)
												  GROUND:CharSetEmote(audino, "exclaim", 1) end)
	local coro6 = TASK:BranchCoroutine(function() GAME:WaitFrames(24)
												   GROUND:CharSetEmote(snubbull, "notice", 1) end)	
	local coro7 = TASK:BranchCoroutine(function() GAME:WaitFrames(30)
												  GROUND:CharSetEmote(hero, "notice", 1) end)									 
	local coro8 = TASK:BranchCoroutine(function() GAME:WaitFrames(20)
												  GROUND:CharSetEmote(partner, "exclaim", 1) end)
	local coro9 = TASK:BranchCoroutine(function() GAME:WaitFrames(20)
												  GROUND:CharSetEmote(tropius, "exclaim", 1) end)
	local coro10 = TASK:BranchCoroutine(function() GAME:WaitFrames(30)
												   GROUND:CharSetEmote(noctowl, "exclaim", 1) end)
	local coro11 = TASK:BranchCoroutine(function() UI:WaitShowTimedDialogue("Alright Pok√©mon,[pause=10] let's get to the day's adventures![pause=10]\n(I've always wanted to say that part,[pause=10] heheh!)", 60) end)
	
	TASK:JoinCoroutines({coro1, coro2, coro3, coro4, coro5, coro6, coro7, coro8, coro9, coro10, coro11})
	GAME:WaitFrames(10)
	
	--everyone looks around
	coro1 = TASK:BranchCoroutine(function() GeneralFunctions.LookAround(tropius, 3, 4, true, true, false, Direction.Down) end)
	coro2 = TASK:BranchCoroutine(function() GAME:WaitFrames(10) GeneralFunctions.LookAround(noctowl, 3, 4, true, false, false, Direction.Down) end)
	coro3 = TASK:BranchCoroutine(function() GAME:WaitFrames(2) GeneralFunctions.LookAround(growlithe, 3, 4, true, false, false, Direction.UpLeft) end)
	coro4 = TASK:BranchCoroutine(function() GAME:WaitFrames(4) GeneralFunctions.LookAround(zigzagoon, 3, 4, true, false, false, Direction.UpLeft) end)
	coro5 = TASK:BranchCoroutine(function() GAME:WaitFrames(8) GeneralFunctions.LookAround(cranidos, 3, 4, true, false, false, Direction.Up) end)
	coro6 = TASK:BranchCoroutine(function() GAME:WaitFrames(6) GeneralFunctions.LookAround(mareep, 3, 4, true, false, false, Direction.Up) end)
	coro7 = TASK:BranchCoroutine(function() GeneralFunctions.LookAround(audino, 3, 4, true, false, false, Direction.Up) end)
	coro8 = TASK:BranchCoroutine(function() GAME:WaitFrames(4) GeneralFunctions.LookAround(snubbull, 3, 4, true, false, false, Direction.Up) end)
	coro9 = TASK:BranchCoroutine(function() GeneralFunctions.LookAround(partner, 3, 4, true, false, false, Direction.UpRight) end)
	coro10 = TASK:BranchCoroutine(function() GAME:WaitFrames(10) GeneralFunctions.LookAround(hero, 3, 4, true, false, false, Direction.UpRight) end)
	TASK:JoinCoroutines({coro1, coro2, coro3, coro4, coro5, coro6, coro7, coro8, coro9, coro10})

	GAME:WaitFrames(10)
	GeneralFunctions.EmoteAndPause(audino, "Question", true)
	UI:SetSpeaker(audino)
	UI:SetSpeakerEmotion("Surprised")
	UI:WaitShowDialogue("H-hey![pause=0] That w-wasn't the Guildmaster's voice![pause=0] W-who said that?")
	
	GAME:WaitFrames(20)
	UI:SetSpeaker(STRINGS:Format("\\uE040"), true, "", -1, "", RogueEssence.Data.Gender.Unknown)
	UI:WaitShowDialogue("Aww,[pause=10] c'mon![pause=0] We haven't been gone that long![pause=0] Surely you haven't forgotten my sweet voice already?")
	UI:WaitShowDialogue("Look towards the bedrooms,[pause=10] you goofs!")
	
	GAME:WaitFrames(10)
	
	coro1 = TASK:BranchCoroutine(function() GAME:WaitFrames(2)
											GROUND:CharAnimateTurnTo(growlithe, Direction.Right, 4) end)
	coro2 = TASK:BranchCoroutine(function() GAME:WaitFrames(4)
											GROUND:CharAnimateTurnTo(zigzagoon, Direction.Right, 4) end)
	coro3 = TASK:BranchCoroutine(function() GAME:WaitFrames(8)
											GROUND:CharAnimateTurnTo(cranidos, Direction.Right, 4) end)
	coro4 = TASK:BranchCoroutine(function() GAME:WaitFrames(6)
											GROUND:CharAnimateTurnTo(mareep, Direction.Right, 4) end)
	coro5 = TASK:BranchCoroutine(function() GROUND:CharAnimateTurnTo(audino, Direction.Right, 4) end)
	coro6 = TASK:BranchCoroutine(function() GAME:WaitFrames(4)
											GROUND:CharAnimateTurnTo(snubbull, Direction.Right, 4) end)	
	coro7 = TASK:BranchCoroutine(function() GAME:WaitFrames(10)
											GROUND:CharAnimateTurnTo(hero, Direction.Right, 4) end)									 
	coro8 = TASK:BranchCoroutine(function() GROUND:CharAnimateTurnTo(partner, Direction.Right, 4) end)
	coro9 = TASK:BranchCoroutine(function() GROUND:CharAnimateTurnTo(tropius, Direction.Right, 4) end)
	coro10 = TASK:BranchCoroutine(function() GAME:WaitFrames(6)
						                     GROUND:CharAnimateTurnTo(noctowl, Direction.Right, 4) end)
	coro11 = TASK:BranchCoroutine(function() GAME:MoveCamera(520, 268, 72, false) end)
	
	TASK:JoinCoroutines({coro1, coro2, coro3, coro4, coro5, coro6, coro7, coro8, coro9, coro10, coro11})
	
	GAME:WaitFrames(20)
	UI:SetSpeaker(zigzagoon)
	UI:SetSpeakerEmotion("Inspired")
	UI:WaitShowDialogue("Oh![pause=0] It's " .. breloom:GetDisplayName() .. " and " .. girafarig:GetDisplayName() .. "![pause=0] They're back from their trip!")
	GAME:WaitFrames(20)
	
	SOUND:PlayBGM("Wigglytuff's Guild Remix.ogg", true)
	
	--everyone crowds around as they walk over
	coro1 = TASK:BranchCoroutine(function() GeneralFunctions.EightWayMove(breloom, 424, 252, false, 1)
											GROUND:CharAnimateTurnTo(breloom, Direction.Down, 4) end)
	coro2 = TASK:BranchCoroutine(function() GROUND:CharAnimateTurnTo(girafarig, Direction.Up, 4)
											GROUND:MoveToPosition(girafarig, 632, 280, false, 1)
											GeneralFunctions.EightWayMove(girafarig, 456, 252, false, 1)
											GROUND:CharAnimateTurnTo(girafarig, Direction.Down, 4) end)
	coro3 = TASK:BranchCoroutine(function() GAME:WaitFrames(2)
											GeneralFunctions.FaceMovingCharacter(growlithe, breloom, 4, Direction.UpLeft)--done on 142
											GAME:WaitFrames(40)
											GROUND:MoveInDirection(growlithe, Direction.Left, 8, false, 1)
											GROUND:MoveInDirection(growlithe, Direction.UpLeft, 12, false, 1)
											GROUND:CharSetAnim(growlithe, "Idle", true) 
											end)
	coro4 = TASK:BranchCoroutine(function() GAME:WaitFrames(4)
											GeneralFunctions.FaceMovingCharacter(zigzagoon, breloom, 4, Direction.UpLeft) --done on 155
											GAME:WaitFrames(30)
											GROUND:MoveInDirection(zigzagoon, Direction.UpLeft, 20, false, 1)
											GROUND:CharSetAnim(zigzagoon, "Idle", true) 
											end)
	coro5 = TASK:BranchCoroutine(function() GAME:WaitFrames(8)
											GeneralFunctions.FaceMovingCharacter(cranidos, breloom, 4, Direction.Up) --done on 138
											GAME:WaitFrames(50)
											GROUND:MoveInDirection(cranidos, Direction.UpLeft, 10, false, 1)
											end)
	coro6 = TASK:BranchCoroutine(function() GAME:WaitFrames(6)
											GeneralFunctions.FaceMovingCharacter(mareep, breloom, 4, Direction.Up)--done on 151
											GAME:WaitFrames(36)
											GROUND:MoveInDirection(mareep, Direction.UpLeft, 8, false, 1)
											GROUND:CharSetAnim(mareep, "Idle", true)
											end)
	coro7 = TASK:BranchCoroutine(function() GeneralFunctions.FaceMovingCharacter(audino, breloom, 4, Direction.Up)--done on 170
											GAME:WaitFrames(20)
											GROUND:MoveInDirection(audino, Direction.Up, 8, false, 1)
											GROUND:CharSetAnim(audino, "Idle", true) 
											end)
	coro8 = TASK:BranchCoroutine(function() GAME:WaitFrames(4)
											GeneralFunctions.FaceMovingCharacter(snubbull, breloom, 4, Direction.Up)--done on 181
											GAME:WaitFrames(10)
											GROUND:MoveInDirection(snubbull, Direction.Up, 6, false, 1)
											end)	
	coro9 = TASK:BranchCoroutine(function() GAME:WaitFrames(10)
											GeneralFunctions.FaceMovingCharacter(hero, breloom, 4, Direction.UpRight) 
											GAME:WaitFrames(60)
											GROUND:MoveInDirection(hero, Direction.Right, 22, false, 1)
											GROUND:MoveInDirection(hero, Direction.UpRight, 18, false, 1)
											end)									 
	coro10 = TASK:BranchCoroutine(function() GAME:WaitFrames(100)
											 GROUND:EntTurn(partner, Direction.UpRight)
											 GAME:WaitFrames(80)
											 GROUND:MoveInDirection(partner, Direction.Right, 30, false, 1)
											 GROUND:MoveInDirection(partner, Direction.UpRight, 10, false, 1)
											 GROUND:CharSetAnim(partner, "Idle", true)
											 end)
	coro11 = TASK:BranchCoroutine(function() GAME:WaitFrames(140)
											 GROUND:CharAnimateTurnTo(tropius, Direction.UpLeft, 4)
											 GeneralFunctions.EightWayMove(tropius, 392, 252, false, 1)
											 GROUND:CharAnimateTurnTo(tropius, Direction.Right, 4)
											 end)	
	local coro12 = TASK:BranchCoroutine(function() GAME:WaitFrames(136)
												   GROUND:CharAnimateTurnTo(noctowl, Direction.Up, 4)
												   GeneralFunctions.EightWayMove(noctowl, 400, 228, false, 1)
												   GROUND:CharAnimateTurnTo(noctowl, Direction.DownRight, 4)
												   end)
	local coro13 = TASK:BranchCoroutine(function() GAME:WaitFrames(90)
												   GeneralFunctions.CenterCamera({snubbull, tropius}, GAME:GetCameraCenter().X, GAME:GetCameraCenter().Y, 1) end)
	
	TASK:JoinCoroutines({coro1, coro2, coro3, coro4, coro5, coro6, coro7, coro8, coro9, coro10, coro11, coro12, coro13})

	GAME:WaitFrames(10)
	GeneralFunctions.DoubleHop(growlithe, nil, 6, 6, true, true)
	GROUND:CharSetAnim(growlithe, "Idle", true)
	GROUND:CharSetEmote(growlithe, "happy", 0)
	UI:SetSpeaker(growlithe)
	UI:SetSpeakerEmotion("Inspired")
	UI:WaitShowDialogue(breloom:GetDisplayName() .. " and " .. girafarig:GetDisplayName() .. "![pause=0] What kind of places did you see on your adventure,[pause=10] ruff!?")
	GAME:WaitFrames(20)
	
	UI:SetSpeaker(partner)
	UI:SetSpeakerEmotion("Inspired")
	GROUND:CharSetEmote(partner, "happy", 0)
	UI:WaitShowDialogue("Did you find anything cool on your trip?[pause=0] Tell me tell me tell me!")
	GAME:WaitFrames(20)
	
	UI:SetSpeaker(mareep)
	UI:SetSpeakerEmotion("Inspired")
	GROUND:CharSetEmote(mareep, "happy", 0)
	UI:WaitShowDialogue("You ha-a-a-ave to tell us about your adventure![pause=0] I can't wait any longer to hear about it!")
	GAME:WaitFrames(20)
	
	UI:SetSpeaker(breloom)
	UI:SetSpeakerEmotion("Surprised")
	GROUND:CharSetEmote(breloom, "sweating", 1)
	UI:WaitShowDialogue("W-woah![pause=0] One at a time!")

	GAME:WaitFrames(20)
	GROUND:EntTurn(tropius, Direction.DownRight)
	UI:SetSpeaker(tropius)
	UI:WaitShowDialogue("Now,[pause=10] everyone,[pause=10] let's give them some space.")
	UI:WaitShowDialogue("There'll be plenty of time later for them to tell you all about their adventure!")
	
	GAME:WaitFrames(20)
	GROUND:CharEndAnim(mareep)
	GROUND:CharEndAnim(audino)
	GROUND:CharEndAnim(growlithe)
	GROUND:CharEndAnim(zigzagoon)
	GROUND:CharSetEmote(partner, "", 0)
	GROUND:CharSetEmote(mareep, "", 0)
	GROUND:CharSetEmote(growlithe, "", 0)
	
	coro1 = TASK:BranchCoroutine(function() GROUND:CharEndAnim(partner) 
											GROUND:CharSetEmote(partner, "", 0)
											GROUND:AnimateInDirection(partner, "Walk", Direction.UpRight, Direction.DownLeft, 8, 1, 1)
											end)
	coro2 = TASK:BranchCoroutine(function() GAME:WaitFrames(4)
											GROUND:AnimateInDirection(hero, "Walk", Direction.UpRight, Direction.DownLeft, 8, 1, 1)
											end)	
	coro3 = TASK:BranchCoroutine(function() GAME:WaitFrames(2)
											GROUND:CharEndAnim(growlithe) 
											GROUND:CharSetEmote(growlithe, "", 0)
											GROUND:AnimateInDirection(growlithe, "Walk", Direction.UpLeft, Direction.DownRight, 8, 1, 1)
											end)
	coro4 = TASK:BranchCoroutine(function() GAME:WaitFrames(4)
											GROUND:CharEndAnim(zigzagoon) 
											GROUND:AnimateInDirection(zigzagoon, "Walk", Direction.UpLeft, Direction.DownRight, 8, 1, 1)
											end)
	coro5 = TASK:BranchCoroutine(function() GAME:WaitFrames(8)
											GROUND:AnimateInDirection(cranidos, "Walk", Direction.UpLeft, Direction.DownRight, 8, 1, 1)
											end)
	coro6 = TASK:BranchCoroutine(function() GAME:WaitFrames(6)
											GROUND:CharEndAnim(mareep) 
											GROUND:CharSetEmote(mareep, "", 0)
											GROUND:AnimateInDirection(mareep, "Walk", Direction.UpLeft, Direction.DownRight, 8, 1, 1)
											end)
	coro7 = TASK:BranchCoroutine(function() GROUND:CharEndAnim(audino) 
											GROUND:AnimateInDirection(audino, "Walk", Direction.Up, Direction.Down, 8, 1, 1)
											end)
	coro8 = TASK:BranchCoroutine(function() GAME:WaitFrames(4)
											GROUND:AnimateInDirection(snubbull, "Walk", Direction.Up, Direction.Down, 8, 1, 1)
											end)	
	TASK:JoinCoroutines({coro1, coro2, coro3, coro4, coro5, coro6, coro7, coro8})
	
	GAME:WaitFrames(20)
	UI:SetSpeaker(breloom)
	UI:SetSpeakerEmotion("Happy")
	UI:WaitShowDialogue("Phew![pause=0] That's better.[pause=0] I was getting claustrophobic there!")
	GAME:WaitFrames(20)
	
	
	
	GROUND:EntTurn(tropius, Direction.Right)
	UI:SetSpeaker(tropius)
	UI:SetSpeakerEmotion("Happy")
	UI:WaitShowDialogue(breloom:GetDisplayName() .. "![pause=0] " .. girafarig:GetDisplayName() .. "![pause=0] It's great to have you both home!")
	UI:WaitShowDialogue("How did your exploration go?")
	GAME:WaitFrames(10)
	
	coro1 = TASK:BranchCoroutine(function() GROUND:CharAnimateTurnTo(breloom, Direction.Left, 4) end)
	coro2 = TASK:BranchCoroutine(function() GAME:WaitFrames(4) GROUND:CharAnimateTurnTo(girafarig, Direction.Left, 4) end)
	coro3 = TASK:BranchCoroutine(function() GROUND:CharAnimateTurnTo(audino, Direction.UpLeft, 4) end)
	coro4 = TASK:BranchCoroutine(function() GAME:WaitFrames(4) GROUND:CharAnimateTurnTo(snubbull, Direction.UpLeft, 4) end)
	coro5 = TASK:BranchCoroutine(function() GROUND:CharAnimateTurnTo(partner, Direction.Up, 4) end)
	coro6 = TASK:BranchCoroutine(function() GAME:WaitFrames(10) GROUND:CharAnimateTurnTo(hero, Direction.Up, 4) end)
	
	
	TASK:JoinCoroutines({coro1, coro2, coro3, coro4, coro5, coro6})
	
	UI:SetSpeaker(breloom)
	UI:SetSpeakerEmotion("Happy")
	UI:WaitShowDialogue("It went great![pause=0] " .. girafarig:GetDisplayName() .. " and I saw all sorts of different places during our trip.")
	UI:WaitShowDialogue("Open plains,[pause=10] boiling hot caves,[pause=10] and windy cliffsides![pause=0] You name it,[pause=10] we saw it!")
	UI:WaitShowDialogue("The ruins themselves were interesting too![pause=0] I wish we could have spent more time investigating them.")
	GAME:WaitFrames(10)
	
	GeneralFunctions.DoubleHop(girafarig)
	UI:SetSpeaker(girafarig)
	UI:SetSpeakerEmotion("Happy")
	UI:WaitShowDialogue("Yeah![pause=0] The three of us had a lot of fun on our trip!")
	UI:WaitShowDialogue("We also planned out a route to head on back there like you asked,[pause=10] Guildmaster.")
	UI:WaitShowDialogue(CharacterEssentials.GetCharacterName("Tail") .. "'s really good at figuring out how to backtrack!")
	GAME:WaitFrames(20)
	
	UI:SetSpeaker(tail)
	UI:SetSpeakerEmotion("Special0")
	UI:WaitShowDialogue(".........")
	GAME:WaitFrames(20)
	
	--tropius doesn't miss a beat when it comes to Crum, and just continues on
	UI:SetSpeaker(tropius)
	UI:SetSpeakerEmotion("Inspired")
	UI:WaitShowDialogue("Perfect![pause=0] I knew you'd be able to do it!")
	
	GAME:WaitFrames(10)
	GROUND:CharAnimateTurnTo(tropius, Direction.DownRight, 4)
	UI:SetSpeakerEmotion("Normal")
	GROUND:CharSetEmote(tropius, "happy", 0)
	UI:WaitShowDialogue("Alright Pok√©mon![pause=0] Change of plans!")
	UI:WaitShowDialogue("We'll be leaving on our expedition to explore the northern ruins today!")
	GAME:WaitFrames(10)

	SOUND:FadeOutBGM(60)
	GROUND:CharSetEmote(tropius, '', 0)
	coro1 = TASK:BranchCoroutine(function() GeneralFunctions.Recoil(breloom) end)
	coro2 = TASK:BranchCoroutine(function() GAME:WaitFrames(6) GROUND:CharSetEmote(girafarig, "shock", 1) end)
	coro3 = TASK:BranchCoroutine(function() GAME:WaitFrames(2)
											GROUND:CharSetEmote(growlithe, "exclaim", 1) end)
	coro4 = TASK:BranchCoroutine(function() GAME:WaitFrames(4)
											GROUND:CharSetEmote(zigzagoon, "exclaim", 1) end)
	coro5 = TASK:BranchCoroutine(function() GAME:WaitFrames(8)
											GROUND:CharSetEmote(cranidos, "exclaim", 1) end)
	coro6 = TASK:BranchCoroutine(function() GAME:WaitFrames(6)
											GROUND:CharSetEmote(mareep, "exclaim", 1) end)
	coro7 = TASK:BranchCoroutine(function() GROUND:CharSetEmote(audino, "exclaim", 1) end)
	coro8 = TASK:BranchCoroutine(function() GAME:WaitFrames(4)
											GROUND:CharSetEmote(snubbull, "exclaim", 1) end)	
	coro9 = TASK:BranchCoroutine(function() GAME:WaitFrames(10)
											GROUND:CharSetEmote(hero, "exclaim", 1) end)									 
	coro10 = TASK:BranchCoroutine(function() GROUND:CharSetEmote(partner, "exclaim", 1) end)
	TASK:JoinCoroutines({coro1, coro2, coro3, coro4, coro5, coro6, coro7, coro8, coro9, coro10})
	
	--What? like now?!
	GAME:WaitFrames(10)
	UI:SetSpeaker(breloom)
	UI:SetSpeakerEmotion("Surprised")
	UI:WaitShowDialogue("W-what!?[pause=0] T-today!?[pause=0] You want us to leave today!?[script=0]", {function() return GeneralFunctions.DoubleHop(breloom) end})
	GAME:WaitFrames(16)
	
	GROUND:CharTurnToCharAnimated(tropius, breloom, 4)
	UI:SetSpeaker(tropius)
	UI:SetSpeakerEmotion("Worried")
	UI:WaitShowDialogue("Is that a problem?")
	UI:WaitShowDialogue("I know you two must be exhausted after your journey,[pause=10] but I'd like us to leave as soon as we can!")
	GAME:WaitFrames(20)
	
	UI:SetSpeaker(breloom)
	UI:SetSpeakerEmotion("Worried")
	UI:WaitShowDialogue("Well,[pause=10] you're right that it was an exhausting trip...[pause=0]\nAll that traveling took a lot out of us!")
	GAME:WaitFrames(20)
	
	UI:SetSpeaker(girafarig)
	UI:SetSpeakerEmotion("Worried")
	UI:WaitShowDialogue("We only got back late last night after everyone had gone to sleep.[pause=0] We've barely had a chance to rest!")
	GAME:WaitFrames(30)
	
	UI:SetSpeakerEmotion("Normal")
	UI:WaitShowDialogue("...But we're no pushovers.[pause=0] I know " .. CharacterEssentials.GetCharacterName("Tail") .. " and I still have energy left in us!")
	GAME:WaitFrames(20)
	
	UI:SetSpeaker(breloom)
	GeneralFunctions.Hop(breloom)
	UI:WaitShowDialogue("That goes for me too![pause=0] I've still got plenty more in me!")
	UI:SetSpeakerEmotion("Happy")
	UI:WaitShowDialogue("Guildmaster,[pause=10] we're ready to go whenever you need us to.[pause=0] Just say the word!")
	GAME:WaitFrames(20)
	
	SOUND:PlayBGM("Wigglytuff's Guild.ogg", true)
	UI:SetSpeaker(tropius)
	UI:SetSpeakerEmotion("Happy")
	UI:WaitShowDialogue("Thank you![pause=0] I knew I could rely on the both of you!")
	GAME:WaitFrames(20)
	
	UI:SetSpeakerEmotion("Normal")
	UI:WaitShowDialogue("But we won't be leaving right this moment.")
	UI:WaitShowDialogue("After all,[pause=10] " .. noctowl:GetDisplayName() .. " and I still need to discuss details with the two of you.")
	
	GAME:WaitFrames(20)
	UI:SetSpeaker(breloom)
	UI:WaitShowDialogue("Of course![pause=0] We've got plenty of stories to tell from our trip!")
	
	GAME:WaitFrames(16)
	UI:SetSpeaker(tropius)
	GROUND:CharAnimateTurnTo(tropius, Direction.DownRight, 4)
	UI:WaitShowDialogue("In the meantime,[pause=10] the rest of you should prepare for the long journey ahead.")
	UI:WaitShowDialogue("We won't return from this expedition for quite some time,[pause=10] so stock up on as many supplies as you can.") 
	UI:WaitShowDialogue("But be aware that this expedition is for guild members only.")
	local audino_species = _DATA:GetMonster('audino'):GetColoredName()
	UI:WaitShowDialogue("That is to say,[pause=10] you won't be able to use the " .. audino_species .. " Assembly to add members to your party.")
	UI:WaitShowDialogue("We want to keep this expedition amongst ourselves,[pause=10] so non-guild members aren't allowed to come!")
	GAME:WaitFrames(20)
	UI:WaitShowDialogue("Anyways,[pause=10] once you're finished making your preparations, report back to me in my office.")
	UI:WaitShowDialogue("Once everyone's ready,[pause=10] we'll go over the road ahead and then embark!")
	UI:SetSpeakerEmotion("Happy")
	UI:WaitShowDialogue("Alright Pok√©mon,[pause=10] let's all get a move on!")
	
	GAME:WaitFrames(10)
	
	--HURRAH!
	GROUND:CharSetEmote(growlithe, "happy", 0)
	GROUND:CharSetEmote(zigzagoon, "happy", 0)
	GROUND:CharSetEmote(mareep, "happy", 0)
	GROUND:CharSetEmote(breloom, "happy", 0)
	GROUND:CharSetEmote(audino, "happy", 0)	
	GROUND:CharSetEmote(partner, "happy", 0)

	--turn pokemon so pose is appropriate
	GROUND:EntTurn(growlithe, Direction.Up)
	GROUND:EntTurn(zigzagoon, Direction.Up)
	GROUND:EntTurn(snubbull, Direction.Up)
	GROUND:EntTurn(audino, Direction.Up)
	GROUND:EntTurn(mareep, Direction.Up)
	GROUND:EntTurn(cranidos, Direction.Up)
	GROUND:EntTurn(breloom, Direction.Down)
	GROUND:EntTurn(girafarig, Direction.Down)
	
	GROUND:CharSetAction(growlithe, RogueEssence.Ground.PoseGroundAction(growlithe.Position, growlithe.Direction, RogueEssence.Content.GraphicsManager.GetAnimIndex("Pose")))
	GROUND:CharSetAction(zigzagoon, RogueEssence.Ground.PoseGroundAction(zigzagoon.Position, zigzagoon.Direction, RogueEssence.Content.GraphicsManager.GetAnimIndex("Pose")))
	GROUND:CharSetAction(breloom, RogueEssence.Ground.PoseGroundAction(breloom.Position, breloom.Direction, RogueEssence.Content.GraphicsManager.GetAnimIndex("Pose")))
	GROUND:CharSetAction(girafarig, RogueEssence.Ground.PoseGroundAction(girafarig.Position, girafarig.Direction, RogueEssence.Content.GraphicsManager.GetAnimIndex("Pose")))
	GROUND:CharSetAction(cranidos, RogueEssence.Ground.PoseGroundAction(cranidos.Position, cranidos.Direction, RogueEssence.Content.GraphicsManager.GetAnimIndex("Pose")))
	GROUND:CharSetAction(mareep, RogueEssence.Ground.PoseGroundAction(mareep.Position, mareep.Direction, RogueEssence.Content.GraphicsManager.GetAnimIndex("Pose")))
	GROUND:CharSetAction(audino, RogueEssence.Ground.PoseGroundAction(audino.Position, audino.Direction, RogueEssence.Content.GraphicsManager.GetAnimIndex("Pose")))
	GROUND:CharSetAction(snubbull, RogueEssence.Ground.PoseGroundAction(snubbull.Position, snubbull.Direction, RogueEssence.Content.GraphicsManager.GetAnimIndex("Pose")))	
	GROUND:CharSetAction(partner, RogueEssence.Ground.PoseGroundAction(partner.Position, partner.Direction, RogueEssence.Content.GraphicsManager.GetAnimIndex("Pose")))	
	GROUND:CharSetAction(hero, RogueEssence.Ground.PoseGroundAction(hero.Position, hero.Direction, RogueEssence.Content.GraphicsManager.GetAnimIndex("Pose")))	
	UI:SetSpeaker('[color=#00FFFF]Everyone[color]', true, "", -1, "", RogueEssence.Data.Gender.Unknown)	
	UI:WaitShowDialogue("HURRAH!")
	GAME:WaitFrames(20)
	GROUND:CharSetEmote(growlithe, "", 0)
	GROUND:CharSetEmote(zigzagoon, "", 0)
	GROUND:CharSetEmote(mareep, "", 0)
	GROUND:CharSetEmote(breloom, "", 0)
	GROUND:CharSetEmote(audino, "", 0)	
	GROUND:CharSetEmote(partner, "", 0)
	GROUND:CharEndAnim(growlithe)
	GROUND:CharEndAnim(zigzagoon)
	GROUND:CharEndAnim(breloom)
	GROUND:CharEndAnim(girafarig)
	GROUND:CharEndAnim(partner)
	GROUND:CharEndAnim(hero)
	GROUND:CharEndAnim(audino)
	GROUND:CharEndAnim(snubbull)
	GROUND:CharEndAnim(cranidos)
	GROUND:CharEndAnim(mareep)
	
	--penticus, phileas, kino and reinier go to penticus's office, everyone else gathers around
	GAME:WaitFrames(20)
	coro1 = TASK:BranchCoroutine(function() GROUND:MoveToPosition(noctowl, 432, 228, false, 1)
											GROUND:MoveToPosition(noctowl, 440, 220, false, 1)
											GROUND:MoveToPosition(noctowl, 440, 216, false, 1) 	
											GAME:GetCurrentGround():RemoveTempChar(noctowl)
											end)
	coro2 = TASK:BranchCoroutine(function() GAME:WaitFrames(10)
											GROUND:CharAnimateTurnTo(tropius, Direction.UpRight, 4)
											GeneralFunctions.EightWayMove(tropius, 440, 228, false, 1)
											GROUND:MoveToPosition(tropius, 440, 216, false, 1) 	
											GAME:GetCurrentGround():RemoveTempChar(tropius) 
											end)
	coro3 = TASK:BranchCoroutine(function() GAME:WaitFrames(30)
											GROUND:CharAnimateTurnTo(breloom, Direction.Up, 4)
											GAME:WaitFrames(20)
											GeneralFunctions.EightWayMove(breloom, 440, 216, false, 1) 	
											GAME:GetCurrentGround():RemoveTempChar(breloom)
											end)
	coro4 = TASK:BranchCoroutine(function() GAME:WaitFrames(34)
											GROUND:CharAnimateTurnTo(girafarig, Direction.Up, 4)
											GAME:WaitFrames(40)
											GeneralFunctions.EightWayMove(girafarig, 440, 216, false, 1) 	
											GAME:GetCurrentGround():RemoveTempChar(girafarig) 
											end)
	coro5 = TASK:BranchCoroutine(function() GAME:WaitFrames(96)
											GeneralFunctions.EightWayMove(snubbull, 428, 258, false, 1)
											GROUND:CharAnimateTurnTo(snubbull, Direction.Down, 4)
											end)	
	coro6 = TASK:BranchCoroutine(function() GAME:WaitFrames(92)
											GeneralFunctions.EightWayMove(partner, 404, 270, false, 1)
											GROUND:CharAnimateTurnTo(partner, Direction.DownRight, 4)
											end)
	coro7 = TASK:BranchCoroutine(function() GAME:WaitFrames(100)
											GeneralFunctions.EightWayMove(hero, 404, 298, false, 1)
											GROUND:CharAnimateTurnTo(hero, Direction.UpRight, 4)
											end)
	coro8 = TASK:BranchCoroutine(function() GAME:WaitFrames(104)
											GeneralFunctions.EightWayMove(audino, 428, 310, false, 1)
											GROUND:CharAnimateTurnTo(audino, Direction.Up, 4)
											end)	
	coro9 = TASK:BranchCoroutine(function() GAME:WaitFrames(98)
											GeneralFunctions.EightWayMove(cranidos, 452, 310, false, 1)
											GROUND:CharAnimateTurnTo(cranidos, Direction.Up, 4)
											end)
	coro10 = TASK:BranchCoroutine(function() GAME:WaitFrames(94)
											GeneralFunctions.EightWayMove(zigzagoon, 476, 298, false, 1)
											GROUND:CharAnimateTurnTo(zigzagoon, Direction.UpLeft, 4)
											end)
	coro11 = TASK:BranchCoroutine(function() GAME:WaitFrames(100)
											GeneralFunctions.EightWayMove(growlithe, 476, 270, false, 1)
											GROUND:CharAnimateTurnTo(growlithe, Direction.DownLeft, 4)
											end)
	coro12 = TASK:BranchCoroutine(function() GAME:WaitFrames(96)
											GeneralFunctions.EightWayMove(mareep, 452, 258, false, 1)
											GROUND:CharAnimateTurnTo(mareep, Direction.Down, 4)
											end)
	
	TASK:JoinCoroutines({coro1, coro2, coro3, coro4, coro5, coro6, coro7, coro8, coro9, coro10, coro11, coro12})


	--audino is just happy to not have to do chores
	--snubbull wonders if they'll find an exotic ingredient in the ruins
	--partner is super excited just for the adventure experience itself
	--player strange and tingly, but maybe it's just the excitement?
	--growlithe is happy to no longer be stuck on sentry duty
	--zigzagoon gonna learn a lot and adventure with hyko again
	--mareep is excited to for a change of pace with cranidos
	--cranidos gets flustered and agrees
	--well we cant dawdle here. we'd better get ready to head out! everyone then walks off
	GAME:WaitFrames(20)
	GeneralFunctions.DoubleHop(growlithe, nil, 6, 6, true, true)
	UI:SetSpeaker(growlithe)
	GROUND:CharSetAnim(growlithe, "Idle", true)
	UI:SetSpeakerEmotion("Inspired")
	UI:WaitShowDialogue("It's here![pause=0] The expedition is finally here,[pause=10] no more sentry duty for me,[pause=10] ruff!")
	UI:SetSpeakerEmotion("Joyous")
	GROUND:CharSetEmote(growlithe, "glowing", 0)
	UI:WaitShowDialogue("I'm so excited,[pause=10] I feel like I'm gonna faint,[pause=10] ruff,[pause=10] ruff!")
	GAME:WaitFrames(20)
	
	GROUND:CharEndAnim(growlithe)
	GROUND:CharSetEmote(growlithe, "", 0)
	UI:SetSpeaker(zigzagoon)
	UI:SetSpeakerEmotion("Inspired")
	UI:WaitShowDialogue("Me too![pause=0] It's gonna be great to adventure with you again " .. growlithe:GetDisplayName() .. "!")
	UI:WaitShowDialogue("We're gonna see and learn so much![pause=0] It's gonna be awesome!")
	GAME:WaitFrames(20)
	
	UI:SetSpeaker(snubbull)
	UI:SetSpeakerEmotion("Special0")
	UI:WaitShowDialogue("I'm hoping that we find something truly delectable on this expedition.[pause=0] A rare fruit or spice would be wonderful. " .. STRINGS:Format("\\u266A"))
	UI:SetSpeakerEmotion("Normal")
	UI:WaitShowDialogue("What do you think we'll find,[pause=10] " .. audino:GetDisplayName() .. "?")
	GAME:WaitFrames(20)
	
	UI:SetSpeaker(audino)
	UI:SetSpeakerEmotion("Happy")
	UI:WaitShowDialogue("O-oh,[pause=10] I don't really care what we find.[pause=0] I'm just glad to be out exploring again!")
	UI:WaitShowDialogue("It'll be a nice change of pace from having to do chores!")
	GAME:WaitFrames(20)
	
	UI:SetSpeaker(cranidos)
	UI:WaitShowTimedDialogue("Meh.[pause=30] I prefer catching outlaws to exploring,[pause=10] so I'm not-", 40)
	
	GAME:WaitFrames(10)
	GeneralFunctions.DoubleHop(mareep, nil, 6, 6, true, true)
	GROUND:CharSetAnim(mareep, "Idle", true)
	GROUND:CharSetEmote(mareep, "happy", 0)
	UI:SetSpeaker(mareep)
	UI:SetSpeakerEmotion("Joyous")
	UI:WaitShowDialogue("I'm looking forward to the change of pa-a-a-ace too!")
	UI:WaitShowDialogue("We're excited to go on an exploration for once,[pause=10] aren't we " .. cranidos:GetDisplayName() .. "?")
	GAME:WaitFrames(20)
	
	GROUND:CharEndAnim(mareep)
	GROUND:CharSetEmote(mareep, "", 0)
	UI:SetSpeaker(cranidos)
	GROUND:CharSetEmote(cranidos, "sweating", 1)
	UI:SetSpeakerEmotion("Surprised")
	UI:WaitShowDialogue("Y-yeah![pause=0] It's good to change things up now and then,[pause=10] haha!")
	UI:SetSpeakerEmotion("Happy")
	UI:WaitShowDialogue("I c-can't wait to explore with you,[pause=10] " .. GeneralFunctions.NameStutter(mareep) .. "!")
	GAME:WaitFrames(20)
	
	GeneralFunctions.Hop(partner)
	UI:SetSpeaker(partner)
	UI:SetSpeakerEmotion("Inspired")
	UI:WaitShowDialogue("This expedition is the sort of thing I've been wanting to do for so long!")
	UI:WaitShowDialogue("An adventure to discover the secret of an ancient ruin with so many friends...")
	UI:WaitShowDialogue("It's something I've only ever dreamed of doing,[pause=10] and now it's actually happening!")
	UI:SetSpeakerEmotion("Teary-Eyed")
	UI:WaitShowDialogue("It's making me feel a little emotional,[pause=10] [script=0]sob...", {function() TASK:BranchCoroutine(function() return GeneralFunctions.Shake(partner) end) end})
	GAME:WaitFrames(20)
	GeneralFunctions.DoubleHop(partner)
	UI:SetSpeakerEmotion("Inspired")
	UI:WaitShowDialogue("This is gonna be the best adventure ever!")
	GAME:WaitFrames(20)

	
	GeneralFunctions.HeroDialogue(hero, "(The expedition is shaping up to be something special![pause=0] I'm feeling pumped up about it!)", "Happy")
	GeneralFunctions.HeroDialogue(hero, "(I don't know if what I'm feeling is that strange tension or just plain excitement,[pause=10] but I don't care!)", "Inspired")
	GeneralFunctions.HeroDialogue(hero, "(I'm just happy to be going on this expedition with " ..  partner:GetDisplayName() .. "!)", "Inspired")
	GAME:WaitFrames(20)
	
	UI:SetSpeaker(growlithe)
	UI:SetSpeakerEmotion("Happy")
	SOUND:PlayBattleSE('EVT_Emote_Startled_2')
	GeneralFunctions.DoubleHop(growlithe)
	GROUND:CharSetAnim(growlithe, "Idle", true)
	coro1 = TASK:BranchCoroutine(function() UI:WaitShowTimedDialogue("Ruff![pause=30] I can't wait any longer![pause=30] I'm gonna head into town right now to get ready,[pause=10] ruff!", 40) end)
	coro2 = TASK:BranchCoroutine(function() GAME:WaitFrames(35) 
											GROUND:CharAnimateTurnTo(growlithe, Direction.Right, 4)
											GROUND:MoveToPosition(growlithe, 557, 272, true, 3)
											GROUND:MoveToPosition(growlithe, 629, 200, true, 3) 
											GROUND:Hide("Growlithe")
											end)
	coro3 = TASK:BranchCoroutine(function() GAME:WaitFrames(14) 
											GROUND:CharAnimateTurnTo(zigzagoon, Direction.Up, 4)
											GAME:WaitFrames(34)
											GROUND:CharSetEmote(zigzagoon, "exclaim", 1)
											SOUND:PlayBattleSE('EVT_Emote_Exclaim_2')
											GeneralFunctions.FaceMovingCharacter(zigzagoon, growlithe, 4, Direction.UpRight)				
											end)
	coro4 = TASK:BranchCoroutine(function() GAME:WaitFrames(18) 
											GROUND:CharAnimateTurnTo(cranidos, Direction.UpRight, 4)
											end)
	coro5 = TASK:BranchCoroutine(function() GAME:WaitFrames(16) 
											GROUND:CharAnimateTurnTo(mareep, Direction.Right, 4)
											GAME:WaitFrames(34)
											GROUND:CharSetEmote(mareep, "exclaim", 1)
											end)
	coro6 = TASK:BranchCoroutine(function() GAME:WaitFrames(22) 
											GROUND:CharAnimateTurnTo(snubbull, Direction.Right, 4)
											end)	
	coro7 = TASK:BranchCoroutine(function() GAME:WaitFrames(20) 
											GROUND:CharAnimateTurnTo(partner, Direction.Right, 4)
											GAME:WaitFrames(30)
											GROUND:CharSetEmote(partner, "exclaim", 1)
											end)
	coro8 = TASK:BranchCoroutine(function() GAME:WaitFrames(58)
											GROUND:CharSetEmote(hero, "notice", 1)
											end)
	coro9 = TASK:BranchCoroutine(function() GAME:WaitFrames(14) 
											GROUND:CharAnimateTurnTo(audino, Direction.UpRight, 4)
											GAME:WaitFrames(36)
											GROUND:CharSetEmote(audino, "notice", 1)
											end)											
	TASK:JoinCoroutines({coro1, coro2, coro3, coro4, coro5, coro6, coro7, coro8, coro9})
	
	GAME:WaitFrames(20)
	UI:SetSpeaker(zigzagoon)
	UI:SetSpeakerEmotion("Surprised")
	GROUND:CharSetEmote(zigzagoon, "sweating", 1)
	UI:WaitShowDialogue(growlithe:GetDisplayName() .. ",[pause=10] wait!")
	GAME:WaitFrames(20)
	
	GeneralFunctions.EmoteAndPause(zigzagoon, "Sweatdrop", true)
	GAME:WaitFrames(20)
	GROUND:CharAnimateTurnTo(zigzagoon, Direction.Left, 4)
	UI:SetSpeakerEmotion("Normal")
	coro1 = TASK:BranchCoroutine(function() UI:WaitShowDialogue("Well,[pause=10] that's my cue to go make my preparations.[pause=0] See you all in a little bit!") end)
	coro2 = TASK:BranchCoroutine(function() GAME:WaitFrames(16)
											GROUND:CharAnimateTurnTo(mareep, Direction.DownRight, 4)
											end)
	coro3 = TASK:BranchCoroutine(function() GAME:WaitFrames(18) 
											GROUND:CharAnimateTurnTo(cranidos, Direction.Right, 4)
											end)
	coro4 = TASK:BranchCoroutine(function() GAME:WaitFrames(14) 
											GROUND:CharAnimateTurnTo(audino, Direction.Right, 4)
											end)
	coro5 = TASK:BranchCoroutine(function() GAME:WaitFrames(22) 
											GROUND:CharAnimateTurnTo(snubbull, Direction.DownRight, 4)
											end)		
	coro6 = TASK:BranchCoroutine(function() GAME:WaitFrames(20) 
											GROUND:CharAnimateTurnTo(hero, Direction.Right, 4)
											end)
	TASK:JoinCoroutines({coro1, coro2, coro3, coro4, coro5, coro6})
	GAME:WaitFrames(10)
	
	UI:SetSpeaker(mareep)
	coro1 = TASK:BranchCoroutine(function() GAME:WaitFrames(60)
											UI:WaitShowDialogue("We gotta go get ready too![pause=0] Ooh,[pause=10] this expedition's gonna be a bla-a-a-ast!") end)
	coro2 = TASK:BranchCoroutine(function() GROUND:CharAnimateTurnTo(zigzagoon, Direction.Right, 4)
											GROUND:MoveToPosition(zigzagoon, 530, 298, false, 1)
											GROUND:MoveToPosition(zigzagoon, 628, 200, false, 1) 
											GROUND:Hide("Zigzagoon")
											end)
	coro3 = TASK:BranchCoroutine(function() GAME:WaitFrames(54)
											GROUND:CharAnimateTurnTo(mareep, Direction.Down)
											end)
	coro4 = TASK:BranchCoroutine(function() GAME:WaitFrames(64) 
											GROUND:CharAnimateTurnTo(cranidos, Direction.Up, 4)
											end)
	coro5 = TASK:BranchCoroutine(function() GAME:WaitFrames(58) 
											GROUND:CharAnimateTurnTo(audino, Direction.Up, 4)
											end)
	coro6 = TASK:BranchCoroutine(function() GAME:WaitFrames(62) 
											GROUND:CharAnimateTurnTo(snubbull, Direction.Down, 4)
											end)	
	coro7 = TASK:BranchCoroutine(function() GAME:WaitFrames(66) 
											GROUND:CharAnimateTurnTo(hero, Direction.UpRight, 4)
											end)
	coro8 = TASK:BranchCoroutine(function() GAME:WaitFrames(56) 
											GROUND:CharAnimateTurnTo(partner, Direction.DownRight, 4)
											end)
	
	TASK:JoinCoroutines({coro1, coro2, coro3, coro4, coro5, coro6, coro7, coro8})
	
	GAME:WaitFrames(10)	
	UI:SetSpeaker(snubbull)
	coro1 = TASK:BranchCoroutine(function() GAME:WaitFrames(64)
											UI:WaitShowDialogue("We need to prepare as well.[pause=0] I have to stock all sorts of ingredients for such a long trip. " .. STRINGS:Format("\\u266A")) end)
	coro2 = TASK:BranchCoroutine(function() GROUND:CharAnimateTurnTo(mareep, Direction.Right, 4)
											GROUND:MoveToPosition(mareep, 570, 258, false, 1)
											GROUND:MoveToPosition(mareep, 628, 200, false, 1)
											GROUND:Hide('Mareep')
											end)
	coro3 = TASK:BranchCoroutine(function() GAME:WaitFrames(36)
											GeneralFunctions.EightWayMove(cranidos, 570, 258, false, 1)
											GROUND:MoveToPosition(cranidos, 628, 200, false, 1)
											GROUND:Hide('Cranidos')
											end)
	coro4 = TASK:BranchCoroutine(function() GAME:WaitFrames(60)
											GROUND:CharAnimateTurnTo(snubbull, Direction.DownLeft, 4)
											end)	
	coro5 = TASK:BranchCoroutine(function() GAME:WaitFrames(70)
											GROUND:CharAnimateTurnTo(audino, Direction.UpLeft, 4)
											end)	
	coro6 = TASK:BranchCoroutine(function() GAME:WaitFrames(64)
											GROUND:CharAnimateTurnTo(partner, Direction.Right, 4)
											end)	
	coro7 = TASK:BranchCoroutine(function() GAME:WaitFrames(74)
											GROUND:CharAnimateTurnTo(hero, Direction.Right, 4)
											end)	

	TASK:JoinCoroutines({coro1, coro2, coro3, coro4, coro5, coro6, coro7})
	
	GAME:WaitFrames(10)
	coro1 = TASK:BranchCoroutine(function() GROUND:CharAnimateTurnTo(snubbull, Direction.Right, 4)
											GROUND:MoveToPosition(snubbull, 570, 258, false, 1)
											GROUND:MoveToPosition(snubbull, 628, 200, false, 1)
											GROUND:Hide('Snubbull')
											end)
	coro2 = TASK:BranchCoroutine(function() GAME:WaitFrames(44)
											GeneralFunctions.EightWayMove(audino, 570, 258, false, 1)
											GROUND:MoveToPosition(audino, 628, 200, false, 1)
											GROUND:Hide('Audino')
											end)
	TASK:JoinCoroutines({coro1, coro2})
	
	UI:SetSpeaker(partner)
	GROUND:CharTurnToCharAnimated(partner, hero, 4)
	GROUND:CharTurnToCharAnimated(hero, partner, 4)
	UI:SetSpeakerEmotion("Inspired")
	UI:WaitShowDialogue("We should do the same as everyone else and get ready,[pause=10] " .. hero:GetDisplayName() .. "!")
	UI:WaitShowDialogue("Let's head into town and prepare for the expedition![pause=0] Aaaahhh,[pause=10] I can't wait!")
	
	GAME:WaitFrames(20)
	GeneralFunctions.PanCamera()
	SV.Chapter5.FinishedExpeditionAddress = true
	AI:EnableCharacterAI(partner)
	AI:SetCharacterAI(partner, "origin.ai.ground_partner", CH('PLAYER'), partner.Position)
	GAME:CutsceneMode(false)						

end

function guild_third_floor_lobby_ch_5.SecondExpeditionAddress()

	local hero = CH('PLAYER')
	local partner = CH('Teammate1')
	local zone = _DATA.DataIndices[RogueEssence.Data.DataManager.DataType.Zone]:Get('cloven_ruins')

	SOUND:StopBGM() 

	local tropius, noctowl, audino, snubbull, growlithe, zigzagoon, girafarig, 
		  breloom, mareep, cranidos = guild_third_floor_lobby_helper.SetupMorningAddress(false)

	local tail = CharacterEssentials.MakeCharactersFromList({{'Tail'}})

	GAME:FadeIn(40)
	SOUND:PlayBGM("Wigglytuff's Guild Remix.ogg", true)


	GAME:WaitFrames(60)
	GROUND:CharAnimateTurnTo(tropius, Direction.DownLeft, 4)
	GAME:WaitFrames(40)
	GROUND:CharAnimateTurnTo(tropius, Direction.DownRight, 4)
	GAME:WaitFrames(40)
	GROUND:CharAnimateTurnTo(tropius, Direction.Down, 4)
	GAME:WaitFrames(20)
	
	
	UI:SetSpeaker(tropius)
	UI:WaitShowDialogue("Alright![pause=0] It looks like we have everyone.[pause=0] Let's get started here!")
	GAME:WaitFrames(12)
	GROUND:CharTurnToCharAnimated(tropius, noctowl, 4)
	
	UI:WaitShowDialogue(noctowl:GetDisplayName() .. ",[pause=10] would you mind explaining the expedition plans?")
	GAME:WaitFrames(12)
	GROUND:CharTurnToCharAnimated(noctowl, tropius, 4)
	
	UI:SetSpeaker(noctowl)
	UI:WaitShowDialogue("Of course,[pause=10] Guildmaster.")
	GAME:WaitFrames(12)
	GROUND:CharAnimateTurnTo(noctowl, Direction.Down, 4)
	GROUND:CharAnimateTurnTo(tropius, Direction.Down, 4)
	
	--cloven ruins/relic
	--[color=#FFC663]Cloven Ruins[color]
	UI:WaitShowDialogue("As you all already know,[pause=10] our destination is the ruins located in the mountain range far to the north.")
	UI:WaitShowDialogue("For the sake of brevity,[pause=10] I will be referring to them as " .. zone:GetColoredName() .. " from now on.")
	GAME:WaitFrames(10)
	
	UI:SetSpeaker(partner)
	UI:SetSpeakerEmotion("Worried")
	GeneralFunctions.EmoteAndPause(partner, "Question", true)
	UI:WaitShowDialogue(zone:GetColoredName() .. "?[pause=0] Why that name?")
	GAME:WaitFrames(12)
	
	UI:SetSpeaker(breloom)
	UI:SetSpeakerEmotion("Happy")
	local coro1 = TASK:BranchCoroutine(function() GROUND:CharAnimateTurnTo(breloom, Direction.Left, 4)
												  UI:WaitShowDialogue("It's the name me and " .. girafarig:GetDisplayName() .. " came up with.[pause=0] " .. noctowl:GetDisplayName() .. " isn't the only one with a fancy vocab!")
												  UI:WaitShowDialogue("Once we reach the ruins,[pause=10] you'll see how we came up with it!")
												  end)
	local coro2 = TASK:BranchCoroutine(function() GAME:WaitFrames(6) GROUND:CharAnimateTurnTo(girafarig, Direction.Left, 4) end)
	local coro3 = TASK:BranchCoroutine(function() GAME:WaitFrames(12) GROUND:CharAnimateTurnTo(partner, Direction.Right, 4) end)
	local coro4 = TASK:BranchCoroutine(function() GAME:WaitFrames(18) GROUND:CharAnimateTurnTo(hero, Direction.Right, 4) end)
	TASK:JoinCoroutines({coro1, coro2, coro3, coro4})									
	
	GAME:WaitFrames(20)
	UI:SetSpeaker(noctowl)
	UI:WaitShowDialogue("Ahem.[pause=0] Let us stay on track with more pertinent details,[pause=10] please.[pause=0] Time is of the essence.")
	
	GAME:WaitFrames(12)
	UI:SetSpeaker(breloom)
	UI:SetSpeakerEmotion("Worried")
	
	coro1 = TASK:BranchCoroutine(function() GROUND:CharAnimateTurnTo(breloom, Direction.Up, 4)
											GROUND:CharSetEmote(breloom, "sweating", 1)
											UI:WaitShowDialogue("W-whoops.[pause=0] Sorry,[pause=10] " .. noctowl:GetDisplayName() .. "!") end)
	coro2 = TASK:BranchCoroutine(function() GAME:WaitFrames(4) GROUND:CharAnimateTurnTo(girafarig, Direction.Up, 4) end)
	coro3 = TASK:BranchCoroutine(function() GAME:WaitFrames(2) GROUND:CharAnimateTurnTo(partner, Direction.UpRight, 4) end)
	coro4 = TASK:BranchCoroutine(function() GAME:WaitFrames(10) GROUND:CharAnimateTurnTo(hero, Direction.UpRight, 4) end)
	TASK:JoinCoroutines({coro1, coro2, coro3, coro4})	
	GAME:WaitFrames(20)
	
	UI:SetSpeaker(noctowl)
	UI:WaitShowDialogue("To recap,[pause=10] our intelligence suggests that " .. zone:GetColoredName() .. " houses an incredible secret.")
	UI:WaitShowDialogue("What that secret is exactly,[pause=10] we do not know.")
	UI:WaitShowDialogue("Treasure of incalculable value,[pause=10] remnants of an ancient civilization,[pause=10] or perhaps nothing at all.")
	UI:WaitShowDialogue("It could be anything.[pause=0] It is simply an unknown as of now.")
	UI:WaitShowDialogue("While " .. breloom:GetDisplayName() .. " and " .. girafarig:GetDisplayName() .. " made efforts during their scouting trip to uncover what they could...")
	UI:WaitShowDialogue("...They were ultimately unable to solve the mystery of the ruins.")
	UI:WaitShowDialogue("It is our hope that with the entire guild present,[pause=10] we will be able to discover the true nature of " .. zone:GetColoredName() .. ".")
	GAME:WaitFrames(20)
	
	--todo: if a map is made for the game, insert a scene here of opening up the wonder maps.
	UI:WaitShowDialogue("As you all know,[pause=10] " .. zone:GetColoredName() .. " is a great distance from the guild.")
	UI:WaitShowDialogue("I was able to plot out an efficient route thanks to " .. breloom:GetDisplayName() .. " and " .. girafarig:GetDisplayName() .. "'s efforts.")
	UI:WaitShowDialogue("However,[pause=10] I estimate that it will still take several days for us to make the journey.")
	UI:WaitShowDialogue("Furthermore,[pause=10] this route will take us through multiple mystery dungeons which we will need to overcome.")
	UI:WaitShowDialogue("The Guildmaster has come up with a strategy to help us expeditiously pass through these dungeons.")
	GAME:WaitFrames(12)
	
	GROUND:CharTurnToCharAnimated(noctowl, tropius, 4)
	UI:WaitShowDialogue("Guildmaster,[pause=10] if you would?")
	GAME:WaitFrames(12)
	
	GROUND:CharTurnToCharAnimated(tropius, noctowl, 4)
	UI:SetSpeaker(tropius)
	UI:WaitShowDialogue("Sure thing,[pause=10] " .. noctowl:GetDisplayName() .. "!")
	GAME:WaitFrames(10)
	
	coro1 = TASK:BranchCoroutine(function() GROUND:CharAnimateTurnTo(tropius, Direction.Down, 4) end)
	coro2 = TASK:BranchCoroutine(function() GAME:WaitFrames(6) GROUND:CharAnimateTurnTo(noctowl, Direction.Down, 4) end)
	TASK:JoinCoroutines({coro1, coro2})	
	
	UI:WaitShowDialogue("As " .. noctowl:GetDisplayName() .. " said,[pause=10] we'll need to pass through multiple mystery dungeons.")
	UI:WaitShowDialogue("But there's still plenty of regular traveling we have to do as well!")
	UI:WaitShowDialogue("With that in mind,[pause=10] I've decided it's best if we stay as one large group at first.")
	UI:WaitShowDialogue("Staying together will help keep everyone safe and on track towards " .. zone:GetColoredName() .. "!")
	UI:SetSpeakerEmotion("Happy")
	UI:WaitShowDialogue("I think it'll help keep everyone's spirits up too![pause=0] It's more fun traveling together!")
	
	
	GAME:WaitFrames(20)
	UI:SetSpeakerEmotion("Normal")
	UI:WaitShowDialogue("We'll move as one large group until we reach the entrance of the first dungeon.")
	UI:WaitShowDialogue("From there,[pause=10] we'll split up into smaller teams.")
	GROUND:EntTurn(tropius, Direction.DownLeft)
	UI:WaitShowDialogue("As the most experienced,[pause=10] " .. breloom:GetDisplayName() .. " and " .. girafarig:GetDisplayName() .. " will lead the way as a pair.")
	UI:WaitShowDialogue("Their job will be to set up the base camps for us to rest at after each dungeon.")
	GAME:WaitFrames(20)
	
	UI:SetSpeaker(girafarig)
	UI:SetSpeakerEmotion("Happy")
	UI:WaitShowDialogue("You can depend on us,[pause=10] Guildmaster![pause=0] We'll get ahead in the back of all you and get those camps set up!")
	GAME:WaitFrames(16)
	
	UI:SetSpeaker(tropius)
	GROUND:CharAnimateTurnTo(tropius, Direction.Left, 4)
	UI:WaitShowDialogue(noctowl:GetDisplayName() .. " and I will stay as a pair and bring up the rear.")
	UI:WaitShowDialogue("That way,[pause=10] we can help anyone who's struggling with a dungeon.")
	GAME:WaitFrames(12)
	
	GROUND:CharAnimateTurnTo(tropius, Direction.Down, 4)
	UI:WaitShowDialogue("The rest of you will split up into two teams.[pause=0] We'll change these teams up after each dungeon as well.")
	GAME:WaitFrames(20) 
	
	UI:SetSpeaker(zigzagoon)
	UI:SetSpeakerEmotion("Worried")
	UI:WaitShowDialogue("Two teams?[pause=0] But there are eight of us left...")
	GAME:WaitFrames(20)
	
	GeneralFunctions.EmoteAndPause(zigzagoon, "Exclaim", true)
	UI:SetSpeakerEmotion("Happy")
	UI:WaitShowDialogue("Woah![pause=0] So does that mean we'll be teaming up with more than just our usual partner?")
	GAME:WaitFrames(16)
	
	GROUND:CharAnimateTurnTo(tropius, Direction.DownRight, 4)
	UI:SetSpeaker(tropius)
	UI:SetSpeakerEmotion("Happy")
	UI:WaitShowDialogue("Yup![pause=0] This is a good opportunity for teambuilding![pause=0] I'm hoping you'll all be able to learn from each other!")
	UI:WaitShowDialogue("The extra numbers will also make beating the mystery dungeons easier!")
	UI:SetSpeakerEmotion("Normal")
    UI:WaitShowDialogue("But don't worry,[pause=10] I won't split up any of our duos.[pause=0] I know you all adventure best with your partner!")
	
	GAME:WaitFrames(16)
	GROUND:CharAnimateTurnTo(tropius, Direction.Down, 4)
	UI:SetSpeakerEmotion("Normal")
	UI:WaitShowDialogue("We'll travel in these teams until we all reconvene at the next camp,[pause=10] where we'll rest for the night.")
	UI:WaitShowDialogue("In the morning,[pause=10] we'll talk strategy and decide how to change up the teams for the next dungeon.")
	UI:WaitShowDialogue("That about covers it![pause=0] Are there any questions?")
	GAME:WaitFrames(40)	
	GROUND:CharAnimateTurnTo(tropius, Direction.DownLeft, 4)
	GAME:WaitFrames(40)
	GROUND:CharAnimateTurnTo(tropius, Direction.DownRight, 4)
	GAME:WaitFrames(40)
	GROUND:CharAnimateTurnTo(tropius, Direction.Down, 4)
	GAME:WaitFrames(40)

	
	SOUND:PlayBGM("Wigglytuff's Guild.ogg", true)
	UI:WaitShowDialogue("Looks like we're all set then![pause=0] We're ready to roll!")
	UI:SetSpeakerEmotion("Happy")
	UI:WaitShowDialogue("Alright Pok√©mon![pause=0] Let's get this expedition going!")
	GAME:WaitFrames(20)
	
	--HURRAH!
	GROUND:CharSetEmote(growlithe, "happy", 0)
	GROUND:CharSetEmote(zigzagoon, "happy", 0)
	GROUND:CharSetEmote(mareep, "happy", 0)
	GROUND:CharSetEmote(breloom, "happy", 0)
	GROUND:CharSetEmote(audino, "happy", 0)	
	GROUND:CharSetEmote(partner, "happy", 0)

	--turn pokemon so pose is appropriate
	GROUND:EntTurn(growlithe, Direction.Up)
	GROUND:EntTurn(zigzagoon, Direction.Up)
	GROUND:EntTurn(snubbull, Direction.Up)
	GROUND:EntTurn(audino, Direction.Up)
	GROUND:EntTurn(mareep, Direction.Up)
	GROUND:EntTurn(cranidos, Direction.Up)
	GROUND:EntTurn(breloom, Direction.Up)
	GROUND:EntTurn(girafarig, Direction.Up)
	GROUND:EntTurn(partner, Direction.Up)
	GROUND:EntTurn(hero, Direction.Up)
	
	GROUND:CharSetAction(growlithe, RogueEssence.Ground.PoseGroundAction(growlithe.Position, growlithe.Direction, RogueEssence.Content.GraphicsManager.GetAnimIndex("Pose")))
	GROUND:CharSetAction(zigzagoon, RogueEssence.Ground.PoseGroundAction(zigzagoon.Position, zigzagoon.Direction, RogueEssence.Content.GraphicsManager.GetAnimIndex("Pose")))
	GROUND:CharSetAction(breloom, RogueEssence.Ground.PoseGroundAction(breloom.Position, breloom.Direction, RogueEssence.Content.GraphicsManager.GetAnimIndex("Pose")))
	GROUND:CharSetAction(girafarig, RogueEssence.Ground.PoseGroundAction(girafarig.Position, girafarig.Direction, RogueEssence.Content.GraphicsManager.GetAnimIndex("Pose")))
	GROUND:CharSetAction(cranidos, RogueEssence.Ground.PoseGroundAction(cranidos.Position, cranidos.Direction, RogueEssence.Content.GraphicsManager.GetAnimIndex("Pose")))
	GROUND:CharSetAction(mareep, RogueEssence.Ground.PoseGroundAction(mareep.Position, mareep.Direction, RogueEssence.Content.GraphicsManager.GetAnimIndex("Pose")))
	GROUND:CharSetAction(audino, RogueEssence.Ground.PoseGroundAction(audino.Position, audino.Direction, RogueEssence.Content.GraphicsManager.GetAnimIndex("Pose")))
	GROUND:CharSetAction(snubbull, RogueEssence.Ground.PoseGroundAction(snubbull.Position, snubbull.Direction, RogueEssence.Content.GraphicsManager.GetAnimIndex("Pose")))	
	GROUND:CharSetAction(partner, RogueEssence.Ground.PoseGroundAction(partner.Position, partner.Direction, RogueEssence.Content.GraphicsManager.GetAnimIndex("Pose")))	
	GROUND:CharSetAction(hero, RogueEssence.Ground.PoseGroundAction(hero.Position, hero.Direction, RogueEssence.Content.GraphicsManager.GetAnimIndex("Pose")))	
	UI:SetSpeaker('[color=#00FFFF]Everyone[color]', true, "", -1, "", RogueEssence.Data.Gender.Unknown)	
	UI:WaitShowDialogue("HURRAH!")
	
	--perhaps show them leaving?
	
	GAME:WaitFrames(60)
	SOUND:FadeOutBGM(60)
	GAME:FadeOut(false, 60)
	GAME:WaitFrames(120)
	
	UI:SetAutoFinish(true)
	UI:WaitShowVoiceOver("And so,[pause=10] the guild began its long\nexpedition towards " .. zone:GetColoredName() .. ".", -1)
	UI:WaitShowVoiceOver("With the excitement of adventure in the air,\nits members eagerly marched, stopping only at night to rest.", -1)
	UI:WaitShowVoiceOver("After several uneventful days, the group\narrives at its first destination...", -1)
	UI:WaitShowVoiceOver("The border of a great and expansive prairie.", -1)
	UI:SetAutoFinish(false)
	
	GAME:WaitFrames(90)
	GAME:CutsceneMode(false)
	GAME:EnterGroundMap("vast_steppe_entrance", "Main_Entrance_Marker")	
	
	
	 --[[pretty cool name, huh? 
	--UI:WaitShowDialogue(breloom:GetDisplayName() .. " and " .. girafarig:GetDisplayName() .. " have proposed a name for them: [color=#FFC663]Cloven Ruins[color].")
	--UI:WaitShowDialogue("But rather than continuing to refer to them in that verbose manner...[pause=10] " .. breloom:GetDisplayName() .. " and " .. girafarig:GetDisplayName() .. " suggested a name: [color=#FFC663]Cloven Ruins[color].")
	
	--[[
	GAME:WaitFrames(10)
	GROUND:CharAnimateTurnTo(tropius, Direction.Left, 4)
	UI:WaitShowDialogue(noctowl:GetDisplayName() .. ",[pause=10] would you mind explaining the plan to everyone?")
	
	GAME:WaitFrames(10)
	GROUND:CharAnimateTurnTo(noctowl, Direction.Right, 4)
	UI:SetSpeaker(noctowl)
	UI:WaitShowDialogue("Of course,[pause=10] Guildmaster.")
	
	
	
	coro1 = TASK:BranchCoroutine(function() GROUND:CharAnimateTurnTo(breloom, Direction.Left, 4) end)
	coro2 = TASK:BranchCoroutine(function() GAME:WaitFrames(6) GROUND:CharAnimateTurnTo(girafarig, Direction.Left, 4) end)
	coro3 = TASK:BranchCoroutine(function() GAME:WaitFrames(2) GROUND:CharAnimateTurnTo(growlithe, Direction.UpLeft, 4) end)
	coro4 = TASK:BranchCoroutine(function() GAME:WaitFrames(4) GROUND:CharAnimateTurnTo(zigzagoon, Direction.UpLeft, 4) end)
	coro5 = TASK:BranchCoroutine(function() GAME:WaitFrames(8) GROUND:CharAnimateTurnTo(cranidos, Direction.UpLeft, 4) end)
	coro6 = TASK:BranchCoroutine(function() GAME:WaitFrames(6) GROUND:CharAnimateTurnTo(mareep, Direction.UpLeft, 4) end)
	coro7 = TASK:BranchCoroutine(function() GROUND:CharAnimateTurnTo(audino, Direction.UpLeft, 4) end)
	coro8 = TASK:BranchCoroutine(function() GAME:WaitFrames(4) GROUND:CharAnimateTurnTo(snubbull, Direction.UpLeft, 4) end)
	coro9 = TASK:BranchCoroutine(function() GROUND:CharAnimateTurnTo(partner, Direction.Up, 4) end)
	coro10 = TASK:BranchCoroutine(function() GAME:WaitFrames(10) GROUND:CharAnimateTurnTo(hero, Direction.Up, 4) end)
	coro11 = TASK:BranchCoroutine(function() GAME:WaitFrames(6) GROUND:CharAnimateTurnTo(noctowl, Direction.Down, 4) end)

	TASK:JoinCoroutines({coro1, coro2, coro3, coro4, coro5, coro6, coro7, coro8, coro9, coro10, coro11})
	
	UI:WaitShowDialogue("As the Guildmaster explained the other day,[pause=10] ")
	
	
		GAME:WaitFrames(10)
	GeneralFunctions.EmoteAndPause(tropius, "notice", true)
	GROUND:CharAnimateTurnTo(tropius, Direction.DownRight, 4)
	UI:WaitShowDialogue("Oh,[pause=10] and " .. growlithe:GetDisplayName() .. "...")
	UI:WaitShowDialogue("You'll be traveling with me and " .. noctowl:GetDisplayName() .. ".")
	
	GAME:WaitFrames(20)
	SOUND:PlayBattleSE('EVT_Emote_Shock_2')
	GeneralFunctions.EmoteAndPause(growlithe, "Shock", false)
	UI:SetSpeaker(growlithe)
	UI:SetSpeakerEmotion("Shocked")
	UI:WaitShowDialogue("W-what!? B-but!W-why,[pause=10] ruff!?[script=0]", {function() return GeneralFunctions.)
	UI:WaitShowDialogue("I want to adventure with everybody else,[pause=10] ruff![script=0]", {function() return GeneralFunctions.Hop(growlithe) end})
	GAME:WaitFrames(10)
	
	UI:SetSpeaker(tropius)
	UI:SetSpeakerEmotion("Worried")
	UI:WaitShowDialogue("You know how I worry,[pause=10] " .. growlithe:GetDisplayName() .. "...[pause=0] I want you close by so I can keep an eye on you.")
	GAME:WaitFrames(20)
	
	GeneralFunctions.Complain(growlithe)
	UI:SetSpeaker(growlithe)
	UI:SetSpeakerEmotion("Worried")
	UI:WaitShowDialogue("I never get to go on adventures with " .. zigzagoon:GetDisplayName() .. " because you always stick me on sentry duty...")
	UI:WaitShowDialogue("I've been looking forward to this expedition so I could adventure again with him and everybody else.")
	UI:WaitShowDialogue("Please,[pause=10] let me be on the teams with everybody else,[pause=10] ruff![script=0]", {function() return GeneralFunctions.Hop(growlithe) end})
	
	GAME:WaitFrames(20)
	UI:SetSpeaker(tropius)
	UI:SetSpeakerEmotion("Pain")
	UI:WaitShowDialogue(".........")
	]]--
end